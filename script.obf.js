/* ...okay you're not supposed to look at this source... */
var limit=e=>e>=8?e-8:e,tobin=e=>e.toString(2).padStart(3,"0"),torgb=e=>tobin(e).split("1").join("F"),preld=e=>{(new Image).src=e};function Box(e){this.size=e,this.edges=[...Array(4).keys()].map(t=>new Tile(e,`edge_${t}`)),this.trans=[...Array(4).keys()].map(t=>new Tile(e,`tran_${t}`)),this.center=new Tile(e,"center"),(box=document.createElement("div")).className="box",box.style.height=`${e/2}px`,box.style.width=`${e/2}px`,box.style.margin=`-${e/4}px ${e/4}px ${e/4}px -${e/4}px`,this.edges.forEach(e=>box.appendChild(e.elem)),this.trans.forEach(e=>box.appendChild(e.elem)),box.appendChild(this.center.elem),container=document.getElementById("container"),container.style.height=`${e}px`,container.style.width=`${e}px`,container.style.margin=`-${e/2}px ${e/2}px ${e/2}px -${e/2}px`,this.elem=container.appendChild(box),this.draw_state=function(e,t=null){center=this.center,center.elem.style.borderRight=`${this.size/2}px #${torgb(e.val)} solid`,dirs.forEach(function(e){center.elem.style[e.toLocaleLowerCase()]="0px","Right"!=e&&(center.elem.style[`border${e}`]="0px transparent solid")}),this.edges.forEach(function(t,s){dirs.forEach(function(i){t.elem.style[i.toLocaleLowerCase()]=`-${t.size/4}px`,i==dirs[s]?(color="#"+torgb(e.next[s]),t.elem.style[`border${i}`]=`${t.size/4}px ${color} solid`):i!=dirs[(s+2)%4]?t.elem.style[`border${i}`]=`${t.size/4}px transparent solid`:t.elem.style[`border${i}`]="0px transparent solid"})}),this.trans.forEach(e=>e.elem.style.display="none"),transitioning=!1},this.move=function(e){anti_dir=dirs[(e+2)%4],this.elem.parentElement.style.backgroundColor="#"+torgb(state.val),center=this.center,this.elem.childNodes.forEach(e=>e.style.zIndex=e==center.elem?"10":"0"),this.edges[e].elem.style.zIndex="10",this.edges[(e+2)%4].elem.style.zIndex="10",this.trans[e].elem.style.zIndex="10",center.elem.style[`border${anti_dir}`]=center.elem.style.borderRight,dirs.forEach(function(e){e!=anti_dir&&(center.elem.style[`border${e}`]="0px transparent solid")}),this.edges.forEach(function(t,s){s%2!=e%2&&dirs.forEach(function(e){e!=dirs[s]&&(t.elem.style[`border${e}`]="0px transparent solid")})}),this.trans.forEach(function(t,s){dirs[s]!=anti_dir&&(t.elem.style.display="block"),color="#"+torgb(state.next[s]),s==e?dirs.forEach(function(e){t.elem.style[e.toLocaleLowerCase()]=`-${t.size/4}px`,e==dirs[s]?t.elem.style[`border${e}`]=`0px ${color} solid`:t.elem.style[`border${e}`]="0px transparent solid"}):(dirs.forEach(function(e){t.elem.style[e.toLocaleLowerCase()]=`-${t.size/4}px`,e==dirs[s]?t.elem.style[`border${e}`]=`${t.size/4}px ${color} solid`:t.elem.style[`border${e}`]="0px transparent solid"}),t.elem.style[anti_dir.toLocaleLowerCase()]=`${3*t.size/4}px`)}),this.elem.childNodes.forEach(e=>e.offsetHeight),this.elem.childNodes.forEach(e=>e.classList.add("transition")),dirs.forEach(function(t){center.elem.style[t.toLocaleLowerCase()]=`-${this.center.size/4}px`,t==anti_dir?(color=center.elem.style[`border${anti_dir}Color`],center.elem.style[`border${t}`]=`${this.center.size/4}px ${color} solid`):t==dirs[e]?center.elem.style[`border${t}`]="0px transparent solid":center.elem.style[`border${t}`]=`${this.center.size/4}px transparent solid`}),this.edges.forEach(function(t,s){s==e?(color=t.elem.style[`border${dirs[s]}Color`],t.elem.style[`border${dirs[s]}`]=`${t.size/2}px ${color} solid`,dirs.forEach(function(e){t.elem.style[e.toLocaleLowerCase()]="0px",e!=dirs[s]&&(t.elem.style[`border${e}`]="0px transparent solid")})):s!=(e+2)%4&&(t.elem.style[dirs[e].toLocaleLowerCase()]=`${3*t.size/4}px`)}),this.trans.forEach(function(t,s){s==e?dirs.forEach(function(e){e==dirs[s]?(color="#"+torgb(state.next[s]),t.elem.style[`border${e}`]=`${t.size/4}px ${color} solid`):e!=dirs[(s+2)%4]?t.elem.style[`border${e}`]=`${t.size/4}px transparent solid`:t.elem.style[`border${e}`]="0px transparent solid"}):s!=(e+2)%4&&(t.elem.style[anti_dir.toLocaleLowerCase()]=`-${t.size/4}px`)}),this.elem.childNodes.forEach(function(e){setTimeout(function(){e.classList.remove("transition")},trans_time)}),setTimeout(()=>this.draw_state(state),trans_time)},this.finish=function(){this.elem.parentElement.style.backgroundColor="",this.elem.childNodes.forEach(e=>e.offsetHeight),this.elem.childNodes.forEach(e=>e.classList.add("transition")),this.edges.forEach((e,t)=>setTimeout(()=>{e.elem.style.opacity="0",setTimeout(()=>e.elem.classList.remove("transition"),trans_time)},300*(t+1))),setTimeout(()=>{this.center.elem.style.opacity="0",this.elem.style.backgroundImage="url(https://www.mariowiki.com/images/d/d1/Fireworks.gif)",setTimeout(()=>this.elem.classList.remove("transition"),trans_time),this.elem.innerHTML=this.elem.innerHTML+"YAY YOU WON!!<br>(tell kayvon!)"},1500)}}function Tile(e,t){this.size=e,this.elem=document.createElement("div"),this.elem.className="tile",this.elem.id=t}function Graph(e=[],t=[]){this.node_dict={},e.forEach(e=>this.node_dict[e]=[]),this.connect=function(e,t){this.node_dict[e].push(t),this.node_dict[t].push(e)},t.forEach(e=>this.connect(...e)),this.adjacency=function(){var e=Object.keys(this.node_dict),t=Object.values(this.node_dict);return e.map(e=>t.map((t,s)=>Number(e<=s&&t.includes(Number(e)))))},this.equal=function(e,t){return t.every((t,s)=>t.every((t,i)=>Number(e[s][i]==t)))}}var connections=[[0,1],[1,6],[6,2],[2,7],[7,3],[3,4],[4,5],[5,0],[1,2],[2,4],[4,1],[3,5],[5,6],[6,3],[0,0],[7,7]],graph=new Graph([...Array(8).keys()],connections),state={val:null,_last_dir:null,_last_val:null,get next(){return neighbors=graph.node_dict[this.val].slice(0),null!==this._last_dir&&(idx=neighbors.indexOf(state._last_val),move=(4+this._last_dir-idx)%4,neighbors=neighbors.splice(4-move,move).concat(neighbors)),neighbors},set move(e){dir_idx=dirs.indexOf(e),new_val=this.next[dir_idx],this._last_dir=(dir_idx+2)%4,this._last_val=this.val,this.val=new_val,box.move(dir_idx),progress.add=[this._last_val,this.val]},val:6},progress={visited:Array.from(Array(8).keys(),e=>Array.from(Array(8).keys(),e=>0)),_steps:0,set steps(e){this._steps=e,16==this._steps&&graph.equal(graph.adjacency(),this.visited)&&(disable_keys=!0,setTimeout(()=>box.finish(),trans_time+10))},set add(e){order=e[0]>e[1],i=e[Number(order)],j=e[Number(!order)],this.visited[i][j]?this.failed:(this.visited[i][j]=1,this.steps=this._steps+1)},set view(e){e.forEach(e=>console.log(e)),console.log(this._steps)},get failed(){disable_keys=!0,setTimeout(()=>disable_keys=!1,1e3),catch_keys=!0,setTimeout(function(){var e=fails[Math.floor(Math.random()*fails.length)];box.elem.style.backgroundImage="url("+e+")",box.center.elem.style.display="none",box.edges.forEach(e=>e.elem.style.opacity="0.5")},trans_time)},get reset(){this._steps=0,this.visited=Array.from(Array(8).keys(),e=>Array.from(Array(8).keys(),e=>0)),state._last_dir=null,state._last_val=null,state.val=6,box.edges.forEach(e=>e.elem.style.opacity="1"),box.elem.style.backgroundImage="",box.center.elem.style.display="block",box.draw_state(state)}},active_keys={ArrowLeft:"Left",ArrowRight:"Right",ArrowDown:"Bottom",ArrowUp:"Top"},transitioning=!0,trans_time=500,dirs=["Top","Right","Bottom","Left"],fails=["https://images.vexels.com/media/users/3/134546/isolated/preview/b1b61276fef1c4a683aabaa53833c7ca-emoji-emoticon-sad-face-by-vexels.png","https://ih0.redbubble.net/image.421012812.8390/flat,550x550,075,f.u1.jpg","https://davistechteachers.com/wp-content/uploads/macbeachball.gif","https://hips.hearstapps.com/esq.h-cdn.co/assets/15/28/1436275392-key-peele-telemarketer.jpg","http://www.spokesman-recorder.com/wp-content/uploads/2014/07/Editorial-Obama-frustrated-1.jpg","https://i.imgur.com/unzfnaD.jpg","https://images.techhive.com/images/idge/imported/article/ctw/2013/11/08/chrome-extensions-100387242-orig.jpg"];fails.forEach(preld);var box=new Box(400);box.draw_state(state);var disable_keys=!1,catch_keys=!1,down_keys={};document.onkeydown=(e=>{if(!disable_keys)return catch_keys?(progress.reset,void(catch_keys=!1)):void(e.key in down_keys&&down_keys[e.key]||(down_keys[e.key]=!0,!transitioning&&active_keys.hasOwnProperty(e.key)&&(state.move=active_keys[e.key],transitioning=!0)))}),document.onkeyup=(e=>{down_keys[e.key]=!1}),console.log("Nothing to see here!");